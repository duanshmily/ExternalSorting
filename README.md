# 项目背景

用于进行 $2.5$ 亿数据量级别的浮点数排序。

# 上手指南

## 安装要求

1. **CMake** 。项目本身依托的是最新版本的 **CMake** ，**CMake** 是一款跨平台的自动化构建工具。
2. **GCC Clang** 。项目还需要 **C++** 编译工具，其中编译工具需要支持 **C++17** 及以上。

## 安装步骤

1. 安装CMake
2. 配置CMake环境变量
3. 安装C/C++编译器
4. 配置C/C++环境变量

# 测试

1. **检测CMake是否配置成功**。打开命令行窗口，使用命令 ```cmake --version``` ，若配置成功则显示正确的 **CMake** 版本。
2. **检测C++编译工具是否配置成功** 。使用命令 ```g++ --version``` ，若安装成功则显示正确的工具版本。

# 构建

1. Windos平台下：
   
    - 使用命令 ```cmake -G "MinGW Makefiles" 源文件所在目录``` 进行项目构建。
    - 使用命令 ```mingw32-make.exe``` 生成可执行文件。
    - ```bin``` 文件夹下找到可执行文件。

2. Linux平台下：

    - 使用命令 ```cmake 含有CMakeLists.txt 文件的根目录文件夹``` 进行项目构建。
    - 使用命令 ```make``` 生成可执行文件。
    - ```bin``` 文件夹下找到可执行文件。

**注意：**

1. **上述命令默认使用的C/C++编译器为GCC，也可以根据自己需要更改为其他类型的C/C++编译器** 。
2. **在进行 ```cmake``` 构建时，推荐在项目根目录下创建额外的文件夹 ```build``` 在```build``` 中进行项目的构建。**

# 运行

将待测数据文件名称更改为 ```in.txt``` 放入文件夹 ```bin``` 中；**或者在文件 ```src/shared_data.cpp``` 中更改 ```INPUT_POSITION``` 来指定输入的文件位置。**

Windows 平台下双击 ```sort.exe``` 即可运行。

Linux 平台下使用命令 ```可执行文件绝对路径``` 运行即可。

# 查看结果

程序运行结束之后会在运行窗口中报告运行时间并将结果输出在 ```bin``` 目录下的 ```legalOut.txt``` 文件中，输入文件中的非法条目将保存在 ```bin``` 目录下的 ```illegalOut.txt``` 文件中。**或者修改 ```src/shared_data.cpp``` 文件中的```LEAGAL_OUTPUT_POSITION``` 来指定输出文件位置。同样可以修改该文件下的 ```ILLEGAL_OUTPUT_POSIONT``` 来指定非法目录输出位置。**

# 程序特点

1. 程序是**单线程版本**。
2. 可以处理诸如以下类型的浮点数表示形式：
   - $\plusmn$ xxxx
   - $\plusmn$ xxxx.xxxx
   - $\plusmn$ xxxxE/e $\plusmn$ xxxx
   - $\plusmn$ xxxx.xxxxE/e $\plusmn$ xxxx
   - $\plusmn$ .xxxxE/e $\plusmn$ xxxx
    
    **无论输入的合法数据中的小数点和 $E/e$ 是否存在，程序都可以处理，输入的数据中同样也是可以包含前导零**。
3. 程序会**自动筛选出不符合正则表达式** ```^[+-]?\d*\.?\d+([eE][+-]?\d+)?\$``` 的数据项并输出在指定的文件中。
4. **文件的输入和输出路径可以在文件** ```shared_data.cpp``` **中更改**。默认的位置是可执行文件所在的文件夹。
5. **程序输出按照 $\plusmn$ x.xxxxxxxxxxE $\plusmn$ xxx 格式输出。** 其中除非当前数字为 $0$ ，否则输出的第一个数字必不为 $0$ 。
6. 根据输入的数据中所一行包含的最大字符数的那一行的字符数来对 ```shared_data.cpp``` 中变量 ```NUMBER_LENGTH``` 。默认是 $50$ 。
7. 可以手动更改缓冲区的最大大小，同时也可以更改一次归并路数，但是请注意，确保 ```归并路数 * 缓冲区大小 <= 上限内存大小$ ``` 。
8. **在 $2.5$ 亿条数据面前，程序总共的运行时间是 $65s$ 。**

# 注意事项

1. 文件夹doc中包含的是项目相关知识点。
2. 输入的浮点数数据最**后一行需要存在换行**，否则无法处理。
3. 小数位数超过规定位数，那么将进行**四舍五入处理**；指数部分超过规定位数，那么将进行**截断处理**。
4. 针对于以下四舍五入会产生数据进位的数据，进位后导致最高位也会产生进位，按照以上数据超过指定位数的处理规则，会将以下数据变为：
    - -9999999999.999E989898 $\Rightarrow -1.0000000000 \times 10^{999}$
    - -.999999999999e-9999 $\Rightarrow -1.0000000000 \times 10^{-999}$
    - +.9999999999999e+999 $\Rightarrow +1.0000000000 \times 10^{999}$
    
    **数据如此处理过后，可能会出现个别数据排序不正确的情况。**